-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.

-- CAR_TABLE Table Create SQL
CREATE TABLE CAR_TABLE
(
    CAR_ID              VARCHAR2(20)    NOT NULL, 
    CAR_NAME            VARCHAR2(20)    NOT NULL, 
    CAR_TYPE            VARCHAR2(20)    NOT NULL, 
    CAR_FUEL            VARCHAR2(20)    NOT NULL, 
    CAR_DISPLACEMENT    INT             NOT NULL, 
    CAR_COLOR           VARCHAR2(20)    NOT NULL, 
    CAR_AUTO            VARCHAR2(20)    NOT NULL, 
    CONSTRAINT CAR_TABLE_PK PRIMARY KEY (CAR_ID)
)
/

COMMENT ON TABLE CAR_TABLE IS '자동차 테이블'
/

COMMENT ON COLUMN CAR_TABLE.CAR_ID IS '차번호 판'
/

COMMENT ON COLUMN CAR_TABLE.CAR_NAME IS '차 이름'
/

COMMENT ON COLUMN CAR_TABLE.CAR_TYPE IS '차 종류'
/

COMMENT ON COLUMN CAR_TABLE.CAR_FUEL IS '연료 타입(전기/디젤/휘발유/하이브리드)'
/

COMMENT ON COLUMN CAR_TABLE.CAR_DISPLACEMENT IS '배기량'
/

COMMENT ON COLUMN CAR_TABLE.CAR_COLOR IS '차 색깔'
/

COMMENT ON COLUMN CAR_TABLE.CAR_AUTO IS '자동/수동'
/


-- CAR_TABLE Table Create SQL
CREATE TABLE USER_TABLE
(
    USER_ID           VARCHAR2(20)    NOT NULL, 
    USER_PWD          VARCHAR2(20)    NOT NULL, 
    USER_NAME         VARCHAR2(20)    NOT NULL, 
    USER_GENDER       VARCHAR2(20)    NOT NULL, 
    USER_BIRTHDATE    DATE            NOT NULL, 
    USER_PHONE        VARCHAR2(20)    NOT NULL, 
    USER_ADD          VARCHAR2(50)    NOT NULL, 
    USER_EMAIL        VARCHAR2(30)    NOT NULL, 
    USER_TYPE         INT             NOT NULL, 
    CONSTRAINT USER_TABLE_PK PRIMARY KEY (USER_ID)
)
/

COMMENT ON TABLE USER_TABLE IS '회원 테이블'
/

COMMENT ON COLUMN USER_TABLE.USER_ID IS '회원 아이디'
/

COMMENT ON COLUMN USER_TABLE.USER_PWD IS '회원 비밀번호'
/

COMMENT ON COLUMN USER_TABLE.USER_NAME IS '회원 이름'
/

COMMENT ON COLUMN USER_TABLE.USER_GENDER IS '성별'
/

COMMENT ON COLUMN USER_TABLE.USER_BIRTHDATE IS '회원 생년월일'
/

COMMENT ON COLUMN USER_TABLE.USER_PHONE IS '전화번호'
/

COMMENT ON COLUMN USER_TABLE.USER_ADD IS '주소'
/

COMMENT ON COLUMN USER_TABLE.USER_EMAIL IS '이메일'
/

COMMENT ON COLUMN USER_TABLE.USER_TYPE IS '구분'
/


-- CAR_TABLE Table Create SQL
CREATE TABLE CARGROUP_TABLE
(
    USER_ID     VARCHAR2(20)    NOT NULL, 
    CAR_ID      VARCHAR2(20)    NOT NULL, 
    CAR_DATE    DATE            NOT NULL, 
    CAR_STAT    VARCHAR2(20)    NOT NULL, 
    CONSTRAINT CARGROUP_TABLE_PK PRIMARY KEY (USER_ID, CAR_ID)
)
/

COMMENT ON TABLE CARGROUP_TABLE IS '차 그룹'
/

COMMENT ON COLUMN CARGROUP_TABLE.USER_ID IS '회원 아이디'
/

COMMENT ON COLUMN CARGROUP_TABLE.CAR_ID IS '차번호 판'
/

COMMENT ON COLUMN CARGROUP_TABLE.CAR_DATE IS '날짜'
/

COMMENT ON COLUMN CARGROUP_TABLE.CAR_STAT IS '차량 상태'
/

ALTER TABLE CARGROUP_TABLE
    ADD CONSTRAINT FK_CARGROUP_TABLE_USER_ID_USER FOREIGN KEY (USER_ID)
        REFERENCES USER_TABLE (USER_ID)
/

ALTER TABLE CARGROUP_TABLE
    ADD CONSTRAINT FK_CARGROUP_TABLE_CAR_ID_CAR_T FOREIGN KEY (CAR_ID)
        REFERENCES CAR_TABLE (CAR_ID)
/



-- CAR_TABLE Table Create SQL
CREATE TABLE CAR_STATUS_TABLE
(
    CAR_ID                 VARCHAR2(20)    NOT NULL, 
    CAR_ON                 VARCHAR2(20)    NOT NULL, 
    CAR_SPEED              INT             NOT NULL, 
    CAR_DISTANCE           NUMBER          NOT NULL, 
    CAR_AIR                NUMBER          NOT NULL, 
    CAR_DUST               NUMBER          NOT NULL, 
    CAR_FINEDUST           NUMBER          NOT NULL, 
    CAR_TEMP               NUMBER          NOT NULL, 
    CAR_EXT_TEMPERATURE    NUMBER          NOT NULL, 
    CAR_EXT_DUST           NUMBER          NOT NULL, 
    CAR_EXT_FINEDUST       NUMBER          NOT NULL, 
    CAR_HUMIDITY           NUMBER          NOT NULL, 
    CAR_FUEL               NUMBER          NOT NULL, 
    CAR_BAT                NUMBER          NOT NULL, 
    CAR_DATE               DATE            NOT NULL, 
    CAR_HMS                VARCHAR2(20)    NOT NULL, 
    CAR_LAT                FLOAT           NOT NULL, 
    CAR_LOG                FLOAT           NOT NULL, 
    CAR_FILTER             NUMBER          NOT NULL, 
    CAR_ENG_OIL            NUMBER          NOT NULL, 
    CAR_BRAKEOIL           NUMBER          NOT NULL, 
    CAR_ACCOIL             NUMBER          NOT NULL, 
    CAR_COOLWAT            NUMBER          NOT NULL, 
    CAR_ACCEL_PRESSURE     NUMBER          NOT NULL, 
    CAR_BRAKE_PRESSURE     NUMBER          NOT NULL, 
    CAR_DRIVING_COUNT      NUMBER          NOT NULL, 
    CONSTRAINT CAR_STATUS_TABLE_PK PRIMARY KEY (CAR_ID)
)
/

COMMENT ON TABLE CAR_STATUS_TABLE IS '차량 상태 테이블'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_ID IS '차 번호 판'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_SPEED IS '속도'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_AIR IS '공기'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_DUST IS '실내 미세먼지'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_TEMP IS '온도'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_FUEL IS '연료'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_BAT IS '베터리'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_DATE IS '날짜'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_HMS IS '시간'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_LAT IS '위도'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_LOG IS '경도'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_FILTER IS '히터 에어컨 필터  잔량'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_ENG_OIL IS '엔진오일  잔량'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_BRAKEOIL IS '브레이크오일  잔량'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_ACCOIL IS '변속기오일  잔량'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_COOLWAT IS '냉각수  잔량'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_ACCEL_PRESSURE IS '엑셀 패드 압력'
/

COMMENT ON COLUMN CAR_STATUS_TABLE.CAR_BRAKE_PRESSURE IS '브레이크 패드 압력'
/

ALTER TABLE CAR_STATUS_TABLE
    ADD CONSTRAINT FK_CAR_STATUS_TABLE_CAR_ID_CAR FOREIGN KEY (CAR_ID)
        REFERENCES CAR_TABLE (CAR_ID)
/


-- CAR_TABLE Table Create SQL
CREATE TABLE CAR_CONSUMABLE
(
    CAR_ID                VARCHAR2(20)    NOT NULL, 
    CAR_FILTER_ALARM      NUMBER          NOT NULL, 
    CAR_ENG_OIL_ALARM     NUMBER          NOT NULL, 
    CAR_BRAKEOIL_ALARM    NUMBER          NOT NULL, 
    CAR_ACCOIL_ALARM      NUMBER          NOT NULL, 
    CAR_COOLWAT_ALARM     NUMBER          NOT NULL, 
    DATE_FILTER           DATE            NOT NULL, 
    DATE_ENG_OIL          DATE            NOT NULL, 
    DATE_BREAKOIL         DATE            NOT NULL, 
    DATE_ACCOIL           DATE            NOT NULL, 
    DATE_COOLWAT          DATE            NOT NULL, 
    CONSTRAINT CAR_CONSUMABLE_PK PRIMARY KEY (CAR_ID)
)
/

COMMENT ON TABLE CAR_CONSUMABLE IS '차량 소모품 테이블'
/

COMMENT ON COLUMN CAR_CONSUMABLE.CAR_ID IS '차 번호 판'
/

COMMENT ON COLUMN CAR_CONSUMABLE.CAR_FILTER_ALARM IS '히터 에어컨 필터 알람'
/

COMMENT ON COLUMN CAR_CONSUMABLE.CAR_ENG_OIL_ALARM IS '엔진오일 알람'
/

COMMENT ON COLUMN CAR_CONSUMABLE.CAR_BRAKEOIL_ALARM IS '브레이크오일 알람'
/

COMMENT ON COLUMN CAR_CONSUMABLE.CAR_ACCOIL_ALARM IS '변속기오일 알람'
/

COMMENT ON COLUMN CAR_CONSUMABLE.CAR_COOLWAT_ALARM IS '냉각수 알람'
/

COMMENT ON COLUMN CAR_CONSUMABLE.DATE_FILTER IS '히터 에어컨 필터'
/

COMMENT ON COLUMN CAR_CONSUMABLE.DATE_ENG_OIL IS '엔진오일'
/

COMMENT ON COLUMN CAR_CONSUMABLE.DATE_BREAKOIL IS '브레이크오일'
/

COMMENT ON COLUMN CAR_CONSUMABLE.DATE_ACCOIL IS '변속기오일'
/

COMMENT ON COLUMN CAR_CONSUMABLE.DATE_COOLWAT IS '냉각수'
/

ALTER TABLE CAR_CONSUMABLE
    ADD CONSTRAINT FK_CAR_CONSUMABLE_CAR_ID_CAR_T FOREIGN KEY (CAR_ID)
        REFERENCES CAR_TABLE (CAR_ID)
/


-- CAR_TABLE Table Create SQL
CREATE TABLE CAR_TYPE_TABLE
(
    ID          INT             NOT NULL, 
    CAR_TYPE    VARCHAR2(20)    NOT NULL, 
    CONSTRAINT CAR_TYPE_TABLE_PK PRIMARY KEY (ID)
)
/

CREATE SEQUENCE CAR_TYPE_TABLE_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER CAR_TYPE_TABLE_AI_TRG
BEFORE INSERT ON CAR_TYPE_TABLE 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT CAR_TYPE_TABLE_SEQ.NEXTVAL
    INTO :NEW.ID
    FROM DUAL;
END;
/

--DROP TRIGGER CAR_TYPE_TABLE_AI_TRG;
/

--DROP SEQUENCE CAR_TYPE_TABLE_SEQ;
/

COMMENT ON TABLE CAR_TYPE_TABLE IS '자동차 타입 테이블 ( 경차, 소형차, 중형차, 대형차)'
/

COMMENT ON COLUMN CAR_TYPE_TABLE.ID IS '시퀀스'
/

COMMENT ON COLUMN CAR_TYPE_TABLE.CAR_TYPE IS '차 종'
/

ALTER TABLE CAR_TYPE_TABLE
    ADD CONSTRAINT FK_CAR_TYPE_TABLE_CAR_TYPE_CAR FOREIGN KEY (CAR_TYPE)
        REFERENCES CAR_TABLE (CAR_TYPE)
/


-- CAR_TABLE Table Create SQL
CREATE TABLE FUEL_TYPE_TABLE
(
    ID           INT             NOT NULL, 
    FUEL_TYPE    VARCHAR2(20)    NOT NULL, 
    CONSTRAINT FUEL_TYPE_TABLE_PK PRIMARY KEY (ID)
)
/

CREATE SEQUENCE FUEL_TYPE_TABLE_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER FUEL_TYPE_TABLE_AI_TRG
BEFORE INSERT ON FUEL_TYPE_TABLE 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT FUEL_TYPE_TABLE_SEQ.NEXTVAL
    INTO :NEW.ID
    FROM DUAL;
END;
/

--DROP TRIGGER FUEL_TYPE_TABLE_AI_TRG;
/

--DROP SEQUENCE FUEL_TYPE_TABLE_SEQ;
/

COMMENT ON TABLE FUEL_TYPE_TABLE IS '연료 타입'
/

COMMENT ON COLUMN FUEL_TYPE_TABLE.ID IS '시퀀스'
/

COMMENT ON COLUMN FUEL_TYPE_TABLE.FUEL_TYPE IS '연료 타입'
/

ALTER TABLE FUEL_TYPE_TABLE
    ADD CONSTRAINT FK_FUEL_TYPE_TABLE_FUEL_TYPE_C FOREIGN KEY (FUEL_TYPE)
        REFERENCES CAR_TABLE (CAR_FUEL)
/

CREATE TABLE DEVICE_TOKEN_TABLE
(
    USER_ID         VARCHAR2(20)     NOT NULL, 
    DEVICE_TOKEN    VARCHAR2(200)    NOT NULL
)
